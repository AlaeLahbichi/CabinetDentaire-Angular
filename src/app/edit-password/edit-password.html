
<div class="body">
<div class="password-container">
  <h1>Changer le mot de passe</h1>
  <p>Sécurisez votre compte avec un nouveau mot de passe</p>

  <form [formGroup]="passwordForm" (ngSubmit)="onSubmit()">

    <div class="form-group">
      <label for="currentPassword">Mot de passe actuel</label>
      <div class="input-wrapper">
        <input
          [type]="showCurrentPassword ? 'text' : 'password'"
          id="currentPassword"
          formControlName="password"
          [class.error]="isFieldInvalid('currentPassword')"
          placeholder="Entrez votre mot de passe actuel"
        />
        <button type="button" (click)="togglePasswordVisibility('current')">
          {{ showCurrentPassword ? '👁️' : '🔒' }}
        </button>
      </div>
      <div class="error-message" *ngIf="isFieldInvalid('currentPassword')">
        {{ getErrorMessage('currentPassword') }}
      </div>
    </div>
    <div class="form-group">
      <label for="newPassword">Nouveau mot de passe</label>
      <div class="input-wrapper">
        <input
          [type]="showNewPassword ? 'text' : 'password'"
          id="newPassword"
          formControlName="newPassword"
          (input)="checkPasswordStrength()"
          [class.error]="isFieldInvalid('newPassword')"
          placeholder="Entrez votre nouveau mot de passe"
        />
        <button type="button" (click)="togglePasswordVisibility('new')">
          {{ showNewPassword ? '👁️' : '🔒' }}
        </button>
      </div>

      <div class="strength-meter" *ngIf="passwordForm.get('newPassword')?.value">
        <div
          class="strength-bar"
          [ngClass]="passwordStrength.class"
          [style.width.%]="passwordStrength.percentage"
        ></div>
      </div>
      <div class="strength-text" *ngIf="passwordForm.get('newPassword')?.value" [style.color]="passwordStrength.color">
        Force: {{ passwordStrength.text }}
      </div>

      <div class="error-message" *ngIf="isFieldInvalid('newPassword')">
        {{ getErrorMessage('newPassword') }}
      </div>
    </div>

    <div class="form-group">
      <label for="confirmPassword">Confirmer le nouveau mot de passe</label>
      <div class="input-wrapper">
        <input
          [type]="showConfirmPassword ? 'text' : 'password'"
          id="confirmPassword"
          formControlName="confirmPassword"
          [class.error]="isFieldInvalid('confirmPassword') || passwordForm.hasError('mismatch')"
          placeholder="Confirmez votre nouveau mot de passe"
        />
        <button type="button" (click)="togglePasswordVisibility('confirm')">
          {{ showConfirmPassword ? '👁️' : '🔒' }}
        </button>
      </div>

      <div class="success-message" *ngIf="!isFieldInvalid('confirmPassword') && !passwordForm.hasError('mismatch') && passwordForm.get('confirmPassword')?.value">
        ✓ Les mots de passe correspondent
      </div>

      <div class="error-message" *ngIf="isFieldInvalid('confirmPassword') || passwordForm.hasError('mismatch')">
        {{ getErrorMessage('confirmPassword') }}
      </div>
    </div>

    <button type="submit" [disabled]="passwordForm.invalid || isLoading">
      {{ isLoading ? 'Changement en cours...' : 'Changer le mot de passe' }}
    </button>
  </form>

  <div class="success-notification" *ngIf="showSuccess">
    ✓ Mot de passe changé avec succès !
  </div>
</div>
</div>
