<div class="body">
  <app-navbar></app-navbar>
  <main class="main-content" style="margin-top: 10rem;">
    <h1 class="page-title">R√©server une Visite M√©dicale</h1>

    <div class="booking-container" *ngIf="!confirmationVisible">
      <form [formGroup]="reservationForm" (ngSubmit)="onSubmit()" id="bookingForm">
        <div class="form-section">
          <h2 class="section-title">
            <span class="section-icon">üë§</span> Informations du patient
          </h2>
          <div class="form-group">
            <label class="form-label" for="patientName">Nom complet</label>
            <input
              type="text"
              id="patientName"
              class="form-input"
              placeholder="Entrez votre nom complet"
              formControlName="patientName"
              [class.invalid]="reservationForm.get('patientName')?.invalid && reservationForm.get('patientName')?.touched"
            />
          </div>
          <div class="form-group">
            <label class="form-label" for="patientPhone">T√©l√©phone</label>
            <input
              type="tel"
              id="patientPhone"
              class="form-input"
              placeholder="Votre num√©ro de t√©l√©phone"
              formControlName="patientPhone"
              [class.invalid]="reservationForm.get('patientPhone')?.invalid && reservationForm.get('patientPhone')?.touched"
            />
          </div>
          <div class="form-group">
            <label class="form-label" for="patientEmail">Email</label>
            <input
              type="email"
              id="patientEmail"
              class="form-input"
              placeholder="votre.email@exemple.com"
              formControlName="patientEmail"
              [class.invalid]="reservationForm.get('patientEmail')?.invalid && reservationForm.get('patientEmail')?.touched"
            />
          </div>
        </div>

        <div class="form-section">
          <h2 class="section-title">
            <span class="section-icon">üë®‚Äç‚öïÔ∏è</span> Information Consultation
          </h2>
          <div class="form-group">
            <label class="form-label" for="visitType">Type de visite</label>
            <select
              id="visitType"
              class="form-select"
              formControlName="visitType"
              [class.invalid]="reservationForm.get('visitType')?.invalid && reservationForm.get('visitType')?.touched"
            >
              <option value="">S√©lectionnez le type de visite</option>
              <option value="consultation">Consultation g√©n√©rale</option>
              <option value="controle">Visite de contr√¥le</option>
              <option value="urgence">Consultation urgente</option>
              <option value="suivi">Suivi m√©dical</option>
            </select>
          </div>
        </div>

        <div class="form-section">
          <h2 class="section-title">
            <span class="section-icon">üìÖ</span> Date et heure
          </h2>
          <div class="form-group">
            <label class="form-label" for="appointmentDate">Date de rendez-vous</label>
            <input
                type="date"
                id="appointmentDate"
                class="form-input"
                formControlName="appointmentDate"
                (change)="onDateChange($event)"
                [min]="minDate"
            />
          </div>
          <div class="form-group">
            <label class="form-label">Cr√©neaux horaires disponibles</label>
            <div class="time-slots" id="timeSlots">
            <div *ngFor="let time of timeSlots">
                <button
                    type="button"
                    class="time-slot"
                    [disabled]="unavailableTimes.includes(time)"
                    (click)="selectTimeSlot(time)"
                    [ngClass]="{ 'disabled': unavailableTimes.includes(time), 'selected': selectedTime === time }"
                >
                    {{ time }}
                </button>
            </div>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h2 class="section-title">
            <span class="section-icon">üìù</span> Motif de consultation
          </h2>
          <div class="form-group">
            <label class="form-label" for="consultationReason">D√©crivez bri√®vement le motif de votre visite</label>
            <textarea
              id="consultationReason"
              class="form-input"
              rows="4"
              placeholder="D√©crivez votre probl√®me de sant√© ou le motif de votre consultation..."
              formControlName="consultationReason"
            ></textarea>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-secondary" (click)="onCancel()">Annuler</button>
          <button type="submit" class="btn btn-primary">Confirmer le rendez-vous</button>
        </div>
      </form>
    </div>

    <div class="confirmation-card" *ngIf="confirmationVisible" id="confirmationCard">
      <div class="confirmation-icon">‚úÖ</div>
      <h3>Rendez-vous confirm√© !</h3>
      <p>Votre rendez-vous a √©t√© enregistr√© avec succ√®s. Un email de confirmation vous sera envoy√© sous peu.</p>
    </div>
  </main>
</div>
